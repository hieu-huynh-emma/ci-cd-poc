<cookie-consent-bar>
  <div id="cookie-consent-bar" class="fixed bottom-0 z-50 flex w-full items-center justify-center bg-[#3C4196] p-[12px] hidden">
    <div class="items-center md:flex">
      <p class="mb-2 text-[14px] text-white md:mb-0 md:mr-3">
        <span>We use cookies to improve your experience and track website usage.</span>
        <a class="text-[14px] underline" href="/pages/privacy-policy" target="_blank">Learn more</a>
      </p>
      <button id="cookie-consent-button" class="w-full rounded bg-white px-4 py-[6px] text-center text-[14px] font-semibold text-black md:w-max">I understand</button>
    </div>
  </div>
</cookie-consent-bar>

<script type="module">
  class CookieConsentBar extends HTMLElement {
    constructor() {
      super();
      this.button = this.querySelector('#cookie-consent-button')
      this.bar = this.querySelector('#cookie-consent-bar')
    }

    connectedCallback() {
      const hasConsent = localStorage.getItem('emmaCookieConsent')
      if (!hasConsent) this.bar.classList.remove('hidden')
      this.button.addEventListener('click', this.handleClick.bind(this));
    }

    disconnectedCallback() {
      this.button.removeEventListener('click', this.handleClick.bind(this));
    }

    handleClick(event) {
      localStorage.setItem('emmaCookieConsent', "accepted")
      this.bar.classList.add('hidden')
    }
  }

  customElements.define('cookie-consent-bar', CookieConsentBar);
</script>
