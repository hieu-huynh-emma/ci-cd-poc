<div class="site-header-right">
	<a tabindex="-1" class="language-redirection"></a>

	{%- if shop.customer_accounts_enabled -%}
		<a
			href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}"
			class="site-header-right__account"
		>
			<img src="{{ 'account.svg' | asset_url }}" loading="lazy" width="28" height="35">
			<span class="visually-hidden">
        {%- liquid
					if customer
						echo 'customer.account_fallback' | t
					else
						echo 'customer.log_in' | t
					endif
				-%}
      </span>
		</a>
	{%- endif -%}

	{% render 'cart-icon-bubble' %}
</div>

<script>
	// Dont use "https://emma-sleep.ca" because it'll be auto converted to "https://qc.emma-sleep.ca" by shopify on french domain
	const franceUrl = "https://qc.emma-sleep.ca";
	const englishUrl = "https://emma-sleep" + ".ca";

	setTimeout(function() {
		renderLanguageRedirection();
	}, 2000)

	function renderLanguageRedirection() {
		const currentLanguage = $('html').attr('lang');
		const $languageRedirection = $(".site-header-right .language-redirection");
		$languageRedirection.text(currentLanguage === 'en' ? "FRANÃ‡AIS" : "ENGLISH");
		$languageRedirection.attr("href", currentLanguage === 'en' ? franceUrl : englishUrl);
	}

	$('.language-redirection').click(function(e) {
		e.preventDefault()
		const currentLanguage = $('html').attr('lang');
		location.href = currentLanguage === 'en' ? franceUrl : englishUrl;
	})
</script>
