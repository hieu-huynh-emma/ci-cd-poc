{% render 'section_schema_parser' %}

{% assign internalLayers = section.blocks | where: 'type', 'internal_layer' %}
{% assign coverLayer = section.blocks | where: 'type', 'cover_layer' | first %}
{% assign baseLayer = section.blocks | where: 'type', 'base_layer' | first %}
{% assign shadowLayer = section.blocks | where: 'type', 'shadow' | first %}


{{ 'mattress-layers.css' | asset_url | stylesheet_tag }}

<section id="mattress-layers-section" class="section-container spacing-{{ section.settings.container_spacing }}">
    <div class="section-chassis page-boundary">
        <div class="section-body">
            <ul class="layer-gallery">
                <div class="outer-container">
                    {% if coverLayer %}
                        <li class="layer-item cover-layer-item"
                            style="--gutter: {{ coverLayer.settings.gutter }};
                                    --bullet_gutter: {{ coverLayer.settings.bullet_gutter }}%
                                    "
                        >
                            <div class="layer-bullet">
                                <button aria-label="Cover Layer" aria-expanded="true" role="button" class="layer-number">1
                                </button>
                            </div>
                            <div class="layer-photo flex items-center">
                                <img src="{{ coverLayer.settings.image | image_url: width: 1440 }}"
                                     width="1440" height="320">
                            </div>
                        </li>
                    {% endif %}

                    {% for layer in internalLayers %}
                        <li class="layer-item {% if layer.settings.is_thin %}layer-item--thin{% endif %} internal-layer-item" style="
                                --gutter: {{ layer.settings.gutter }};
                                --bullet_gutter: {{ layer.settings.bullet_gutter }}%">
                            <div class="layer-bullet">
                                <button aria-label="Layer {{ forloop.index | plus: 1 }}" aria-expanded="true"
                                        role="button" class="layer-number">{{ forloop.index | plus: 1 }}</button>
                            </div>
                            <div class="layer-photo flex items-center">
                                <img src="{{ layer.settings.image | image_url: width: 1440 }}" width="1440"
                                     height="320">
                            </div>
                        </li>
                    {% endfor %}
                </div>

                {% if baseLayer %}
                    <li class="layer-item base-layer-item" style="
                            --gutter: {{ baseLayer.settings.gutter }};
                            --bullet_gutter: {{ baseLayer.settings.bullet_gutter }}%">
                        <div class="layer-bullet">
                            <button aria-label="Base Layer" aria-expanded="true" role="button"
                                    class="layer-number">{{ internalLayers.size | plus: 2 }}</button>
                        </div>
                        <div class="layer-photo flex items-center">
                            <img src="{{ baseLayer.settings.image | image_url: width: 1440 }}" width="1440"
                                 height="320">
                        </div>
                    </li>
                {% endif %}
                {% if shadowLayer %}
                    <li class="layer-item shadow-layer-item">
                        <div class="layer-photo flex items-center">
                            <img src="{{ shadowLayer.settings.image | image_url: width: 1440 }}" width="1440"
                                 height="320">
                        </div>
                    </li>
                {% endif %}
            </ul>

            <div class="info-wrapper">
                {% render 'section-header' %}
                <ul class="layer-specifications">
                    {% if coverLayer %}
                        <li class="layer-info-item cover-layer hidden">
                            <h4 class="heading-5">{{ coverLayer.settings.title }}</h4>
                            <p class="solid">{{ coverLayer.settings.content }}</p>
                        </li>
                    {% endif %}
                    {% for layer in internalLayers %}
                        <li class="layer-info-item hidden">
                            <h4 class="heading-5">{{ layer.settings.title }}</h4>
                            <p class="solid">{{ layer.settings.content }}</p>
                        </li>
                    {% endfor %}
                    {% if baseLayer %}
                        <li class="layer-info-item base-layer hidden">
                            <h4 class="heading-5">{{ baseLayer.settings.title }}</h4>
                            <p class="solid">{{ baseLayer.settings.content }}</p>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
    <div class="section-wallpaper">
        {{ section.settings.wallpaper | image_url: width: 1920 | image_tag }}
    </div>
    <lazy-script src="{{ 'mattress-layers.js' | asset_url }}"></lazy-script>
</section>


{% schema %}
{
  "name": "Mattress Layers",
  "blocks": [
    {
      "type": "cover_layer",
      "limit": 1,
      "name": "Cover Layer",
      "settings": [
        {
          "id": "image",
          "type": "image_picker",
          "label": "Layer Image"
        },
        {
          "id": "title",
          "type": "text",
          "label": "Layer Title"
        },
        {
          "id": "content",
          "type": "text",
          "label": "Layer Content"
        },
        {
          "id": "gutter",
          "type": "range",
          "label": "Next Layer Gutter",
          "min": 1,
          "max": 100,
          "step": 1,
          "unit": "rem",
          "default": 1
        },
        {
          "id": "bullet_gutter",
          "type": "range",
          "label": "Bullet gutter from top",
          "min": 1,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 50
        }
      ]
    },
    {
      "type": "internal_layer",
      "name": "Internal Layer",
      "settings": [
        {
          "id": "image",
          "type": "image_picker",
          "label": "Layer Image"
        },
        {
          "id": "title",
          "type": "text",
          "label": "Layer Title"
        },
        {
          "id": "content",
          "type": "text",
          "label": "Layer Content"
        },
        {
          "id": "is_thin",
          "type": "checkbox",
          "label": "Is Thin Layer?",
          "default": false
        },
        {
          "id": "gutter",
          "type": "range",
          "label": "Next Layer Gutter",
          "min": 1,
          "max": 100,
          "step": 1,
          "unit": "rem",
          "default": 2
        },
        {
          "id": "bullet_gutter",
          "type": "range",
          "label": "Bullet gutter from top",
          "min": 1,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 50
        }
      ]
    },
    {
      "type": "base_layer",
      "limit": 1,
      "name": "Base Layer",
      "settings": [
        {
          "id": "image",
          "type": "image_picker",
          "label": "Layer Image"
        },
        {
          "id": "title",
          "type": "text",
          "label": "Layer Title"
        },
        {
          "id": "content",
          "type": "text",
          "label": "Layer Content"
        },
        {
          "id": "gutter",
          "type": "range",
          "label": "Next Layer Gutter",
          "min": 1,
          "max": 100,
          "step": 1,
          "unit": "rem",
          "default": 2
        },
        {
          "id": "bullet_gutter",
          "type": "range",
          "label": "Bullet gutter from top",
          "min": 1,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 50
        }
      ]
    },
    {
      "type": "shadow",
      "limit": 1,
      "name": "Shadow Layer",
      "settings": [
        {
          "id": "image",
          "type": "image_picker",
          "label": "Layer Image"
        }
      ]
    }
  ],
  "settings": [
    {
      "id": "wallpaper",
      "type": "image_picker",
      "label": "Section Wallpaper"
    },
    {
      "id": "heading",
      "type": "text",
      "label": "Heading",
      "default": "Emma Original - Layer by Layer"
    },
    {
      "id": "heading_alignment",
      "type": "select",
      "label": "Heading Alignment",
      "options": [
        {
          "value": "start",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "end",
          "label": "Right"
        }
      ],
      "default": "start"
    },
    {
      "type": "select",
      "id": "container_spacing",
      "options": [
        {
          "value": "sm",
          "label": "Small (24px)"
        },
        {
          "value": "md",
          "label": "Medium (40px)"
        },
        {
          "value": "lg",
          "label": "Large (60px)"
        },
        {
          "value": "xl",
          "label": "XL (80px)"
        }
      ],
      "default": "md",
      "label": "Container Spacing"
    },
    {
      "id": "carousel_mode",
      "type": "checkbox",
      "label": "Carousel Mode"
    }
  ]
}
{% endschema %}
