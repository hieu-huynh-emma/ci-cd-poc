<script id="All-Affiliates-JSON" type="application/json">
    [
        {% for block in section.blocks %}
          {{ block.settings |  json }}
            {% unless forloop.last %},{% endunless -%}
        {% endfor %}
    ]
</script>
{{ 'affiliate-banners.css' | asset_url | stylesheet_tag }}

<script type="quickscript" loading="delayed" src="{{ 'affiliate-control.js' | asset_url}}"></script>

{% if section.settings.auto_coupon_enabled %}
  <affiliate-auto-coupon :success="{{ section.settings.success_msg | escape  }}" :error="{{ section.settings.error_msg | escape  }}"></affiliate-auto-coupon>
{% endif %}


<affiliate-layout></affiliate-layout>

{% schema %}
{
  "name": "Affiliate Control",
  "blocks": [
    {
      "type": "affiliate",
      "name": "Affiliate",
      "settings": [
        {
          "id": "id",
          "type": "text",
          "label": "Affiliate ID"
        },
        {
          "id": "heading",
          "type": "text",
          "label": "Affiliate Name"
        },
        {
          "id": "platform",
          "type": "text",
          "label": "Affiliate Platform"
        },
        {
          "type": "image_picker",
          "id": "logo",
          "label": "Affiliate Logo"
        },
        {
          "type": "image_picker",
          "id": "badge",
          "label": "Affiliate Badge"
        },
        {
          "type": "richtext",
          "id": "message",
          "label": "Affiliate Message"
        },
        {
          "type": "text",
          "id": "discount_code",
          "label": "Discount Code"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "checkbox",
      "id": "auto_coupon_enabled",
      "label": {
        "en": "Enable auto discount"
      },
      "default": true
    },
    {
      "type": "text",
      "id": "success_msg",
      "label": {
        "en": "Auto discount Success Text"
      },
      "default": "{discount_code} discount code applied. Add an item to your cart to unlock your discount."
    },
    {
      "type": "text",
      "id": "error_msg",
      "label": {
        "en": "Auto discount failed text"
      },
      "default": "\"{discount_code}\" discount code is invalid."
    }
  ]
}
{% endschema %}
