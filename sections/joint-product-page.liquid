{{ 'revamp-product.css' | asset_url | stylesheet_tag }}
{{ 'joint-product.css' | asset_url | stylesheet_tag }}

<loading-overlay id="page-spinner"></loading-overlay>

<script id="joint-product-data" type="application/json">
    {
      "products": [
    {% for product in metaobject.products.value %}
        {{ product | json }}
        {% unless forloop.last %},{% endunless %}
    {% endfor %}
    ]
  }
</script>


<joint-product-engine></joint-product-engine>

<joint-product-selector class="hidden">
    {% for product in metaobject.products.value %}
        {% assign selected_variant = product.selected_or_first_available_variant %}
        <div class="joint-product-option" data-product-id="{{ product.id }}">
            <div class="flex gap-2 justify-start">
                <p class="font-semibold">{{ product.title }}</p>
            </div>

            <p>
                <span class="font-semibold text-scarlet">{{ selected_variant.price | money_without_trailing_zeros }}</span>
                {% if selected_variant.compare_at_price > selected_variant.price %}
                    <span class="line-through">{{ selected_variant.compare_at_price | money_without_trailing_zeros }}</span>
                {% endif %}
            </p>

            <joint-product-star-rating
                    :placeholder="{{ product.metafields.accentuate.placeholder_star_rating }}"
                    :productId="{{ product.id }}"
            ></joint-product-star-rating>
            {% comment %}<p class="joint-product-option__desc text-comet text-sm">{{ product.metafields.accentuate.short_description }}</p>{% endcomment %}
        </div>
    {% endfor %}
</joint-product-selector>

<div id="fake-yotpo-placeholder" class="hidden">
    {% assign product = metaobject.products.value | first %}
    <div class="yotpo yotpo-main-widget"
         data-product-id="{{ product.id }}"
         data-name="{{ product.title | escape }}"
         data-url="{{ shop.url }}{{ product.url }}"
         data-image-url="{{ product.featured_image | product_img_url: "large" | replace: '?', '%3F' | replace: '&', '%26' }}"
         data-description="{{ product.description | escape }}"
         data-prefilter='{"order_properties":{"year":["2017"]},"customer_properties":{"state": ["New York"]},"customer_custom_properties":null}'
         data-presorting='[{"type": "customer_property", "key": "state", "value": "New York"},{"type": "customer_property", "key": "age", "value": 22},{"type": "customer_property", "key": "still_alive", "value": true}]'>
    </div>
</div>


<script is="delay-script" url="{{ 'joint-product.js' | asset_url }}"></script>


{% schema %}
{
  "name": "Joint Product Page",
  "class": "joint-product-page"
}
{% endschema %}

