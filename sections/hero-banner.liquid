{% assign wallpaper = section.blocks | where: 'type', 'wallpaper' | first %}
{% assign cta = section.blocks | where: 'type', 'cta' | first %}
{% assign countdown = section.blocks | where: 'type', 'countdown' | first %}

<style>
  #hero-banner-section{position: relative;z-index: 1;display: grid;grid-template-rows: 0 minmax(0, 1fr);min-height: 540px;max-height: 540px;padding: 12px}#hero-banner-section h1,#hero-banner-section h2,#hero-banner-section p{margin: 0}@media (min-width: 768px){#hero-banner-section .md\:hidden{display: none}#hero-banner-section .md\:block{display: block}}#hero-banner-section p{font-family: Inter}#hero-banner-section h1{font-family: Tiempos}@media (min-width: 768px){#hero-banner-section h1,#hero-banner-section h2,#hero-banner-section p{margin: 0}}#hero-banner-section .page-boundary--full{height: 100%;padding: 0 12px}@media screen and (min-width: 769px){#hero-banner-section{height: 100%;min-height: 640px;padding: 0}#hero-banner-section .page-boundary--full{padding: 0 20px}}@media screen and (min-width: 1024px){#hero-banner-section .page-boundary--full{padding: 0 40px}}@media screen and (min-width: 1200px){#hero-banner-section .page-boundary--full{padding: 0 64px}}@media screen and (min-width: 1440px){#hero-banner-section .page-boundary--full{width: 1440px;max-width: 1440px;margin: 0 auto}}#hero-banner-section .section-content{position: absolute;display: grid;gap: 24px;align-content: space-between;justify-items: center;height: 100%;padding: calc(24px + 12px) calc(16px + 12px)}@media screen and (max-width: 768px){#hero-banner-section .section-content{inset: 0;width: 100%}}@media screen and (min-width: 768px){#hero-banner-section .section-content{top: 0;gap: 40px;align-content: center;justify-items: flex-start;max-width: 528px;padding: 0}}@media screen and (min-width: 1024px){#hero-banner-section .section-content{margin-left: 112px}}#hero-banner-section .section-content .text-box{display: grid;gap: 16px;justify-items: center;text-align: center}#hero-banner-section .hero-banner__title{font-style: normal;font-weight: 600;font-size: 40px;line-height: 125%}@media screen and (min-width: 768px){#hero-banner-section .section-content .text-box{justify-items: flex-start;text-align: left}#hero-banner-section .hero-banner__title{font-size: 60px;line-height: 120%}}#hero-banner-section .hero-banner__subtitle{font-style: normal;font-weight: 600;font-size: 24px;line-height: 125%;font-family: Inter}#hero-banner-section .hero-banner__tagline{display: none}@media screen and (min-width: 768px){#hero-banner-section .hero-banner__subtitle{font-size: 32px}#hero-banner-section .hero-banner__tagline{display: inline-block}}#hero-banner-section .section-cta{display: grid;gap: 16px;grid-template-columns: minmax(0, 1fr);justify-content: center;width: 100%;max-width: 256px;text-align: center}@media screen and (min-width: 769px){#hero-banner-section .section-cta{max-width: 288px}}#hero-banner-section .section-cta .cta-subtext{margin-top: -8px}#hero-banner-section .wallpaper{z-index: -1;width: 100%;border-radius: 8px;overflow: hidden}#hero-banner-section .wallpaper img{-o-object-fit: cover;object-fit: cover;height: 100%;max-width: 100%}#hero-banner-section .countdown{display: grid;gap: 4px;justify-items: center}@media screen and (min-width: 768px){#hero-banner-section .countdown{justify-items: flex-start}}#hero-banner-section .countdown .countdown-timer{display: grid;gap: 4px;grid-auto-flow: column;grid-auto-columns: minmax(0, 1fr);align-items: center;justify-content: flex-start;width: 100%}#hero-banner-section .countdown .countdown-timer .time-part{display: grid;justify-content: center;padding: 10px;background-color: #fff;border-radius: 4px;text-align: center;height: 64px}#hero-banner-section .countdown .countdown-timer .time-part .digit{font-size: 20px}@media screen and (min-width: 768px){#hero-banner-section .countdown .countdown-timer .time-part{width: 69px;padding: 4px}#hero-banner-section .countdown .countdown-timer .time-part .digit{font-weight: 600;font-size: 32px;line-height: 125%}}#hero-banner-section .countdown .countdown-timer .time-part .label{font-size: 8px}@media screen and (min-width: 768px){#hero-banner-section .countdown .countdown-timer .time-part .label{font-weight: 400;font-size: 12px;line-height: 16px}}#hero-banner-section .btn{display: flex;align-items: center;justify-content: center;min-height: 50px;padding: 10px 28px;background-color: #ffa235;border-radius: 60px;font-family: 'Acumin Pro';font-style: normal;font-weight: 600;font-size: 16px;line-height: 1;text-align: center;text-transform: uppercase;color: #fff;transition: 0.2s ease-in;cursor: pointer}@media screen and (min-width: 768px){.btn{min-height: 50px;padding: 13px 36px}}
</style>

<section id="hero-banner-section">
  <div class="page-boundary--full">
    <div class="section-content">
      <div class="text-box">
        <h1 class="hero-banner__title">{{ section.settings.title | remove: '<p>' | remove: '</p>' }}</h1>
        <h2 class="hero-banner__subtitle">{{ section.settings.subtitle }}</h2>
        <p class="hero-banner__tagline">{{ section.settings.tagline | remove: '<p>' | remove: '</p>' }}</p>
      </div>

      <div class="section-cta">
        {% if countdown != blank %}
          <div class="countdown">
            <p class="paragraph-14 font-semibold text-white md:text-black">{{ countdown.settings.heading }}</p>

            <div class="countdown-timer">
              <div class="time-part">
                <p class="digit"></p>
                <p class="label">Days</p>
              </div>
              <div class="time-part">
                <p class="digit"></p>
                <p class="label">Hours</p>
              </div>
              <div class="time-part">
                <p class="digit"></p>
                <p class="label">Minutes</p>
              </div>
              <div class="time-part">
                <p class="digit"></p>
                <p class="label">Seconds</p>
              </div>
            </div>
          </div>
        {% endif %}

        {% if cta != blank %}
          <a class="btn btn--lg" href="{{ cta.settings.url }}">
            {{ cta.settings.text }}
          </a>

          <p class="cta-subtext text-white md:text-black">{{ cta.settings.subtext }}</p>
        {% endif %}
      </div>
    </div>
  </div>

  {% if wallpaper != blank %}
    <div class="wallpaper">
      {{
        wallpaper.settings.src
        | image_url: width: 2680
        | image_tag: width: 2680, height: 640, class: 'hidden md:block', loading: 'eager'
      }}
      {{
        wallpaper.settings.mobile_src
        | image_url: width: 768
        | image_tag: width: 768, height: 540, class: 'md:hidden', loading: 'eager'
      }}
    </div>
  {% endif %}
</section>

<script is="delay-script" phase="interactive">
  function getTimeParts(delta) {
    var days = Math.floor(delta / 86400);
    delta -= days * 86400;

    var hours = Math.floor(delta / 3600) % 24;
    delta -= hours * 3600;

    var minutes = Math.floor(delta / 60) % 60;
    delta -= minutes * 60;

    var seconds = Math.floor(delta % 60); // in theory the modulus is not required

    return [days, hours, minutes, seconds];
  }

  function renderTimer(delta) {
    var timeParts = getTimeParts(delta);

    $('#hero-banner-section .time-part').each(function (i) {
      $(this).find('.digit').text(timeParts[i]);
    });
  }

  $(document).ready(function () {
    var startTime = Date.now();
    var endTime = new Date('{{ countdown.settings.timer }}'.replace(' ', 'T'));

    var delta = (endTime - startTime) / 1000;

    renderTimer(delta);

    setInterval(function () {
      delta -= 1;
      if (delta >= 0) renderTimer(delta);
    }, 1000);
  });
</script>

{% schema %}
{
  "name": "Hero Banner",
  "blocks": [
    {
      "type": "countdown",
      "name": "Countdown",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Countdown Title"
        },
        {
          "type": "text",
          "id": "timer",
          "label": "Countdown Timer",
          "info": "Please follow format: YYYY-MM-DD HH:mm"
        }
      ]
    },
    {
      "type": "wallpaper",
      "name": "Wallpaper",
      "limit": 1,
      "settings": [
        {
          "id": "src",
          "type": "image_picker",
          "label": "Wallpaper Desktop Srouce"
        },
        {
          "id": "mobile_src",
          "type": "image_picker",
          "label": "Wallpaper Mobile Source"
        }
      ]
    },
    {
      "type": "cta",
      "name": "CTA",
      "limit": 1,
      "settings": [
        {
          "id": "url",
          "type": "url",
          "label": "Button Url"
        },
        {
          "id": "text",
          "type": "text",
          "label": "Button Text"
        },
        {
          "id": "subtext",
          "type": "text",
          "label": "Subtext"
        }
      ]
    },
    {
      "type": "award",
      "name": "Award",
      "limit": 3,
      "settings": [
        {
          "id": "src",
          "type": "image_picker",
          "label": "Image"
        }
      ]
    }
  ],
  "settings": [
    {
      "id": "title",
      "type": "richtext",
      "label": "Title",
      "default": "<p>Hit snooze! Sleep is about to get <i>wayyy better.</i></p>"
    },
    {
      "id": "tagline",
      "type": "richtext",
      "label": "Tagline",
      "default": "<p>Hit snooze! Sleep is about to get <i>wayyy better.</i></p>"
    },
    {
      "id": "subtitle",
      "type": "text",
      "label": "Subtitle",
      "default": "Our sleep experts have mastered designing award-winning mattresses crafted to keep you relaxed and recharged, no matter what kind of sleeper you are. Climb on your best sleep yet!"
    }
  ]
}
{% endschema %}
