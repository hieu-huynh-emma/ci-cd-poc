{% assign subtopicBlocks = section.blocks | where: "type", "subtopic" %}
{% assign questionAnswerBlocks = section.blocks | where: "type", "question_and_answer" %}

<div id="{{ section.settings.slug }}" class="faq-qna-section py-4 lg:py-24">
  <div class="mx-auto max-w-7xl px-4 sm:px-3 md:px-5">
    <div class="lg:flex lg:gap-60">
      <h3 class="mb-5 text-center text-[26px] lg:mb-0 lg:w-1/4 lg:text-left lg:text-[39px]">{{ section.settings.topic_title }}</h3>
      <div class="lg:flex-1">
        {% for subtopicBlock in subtopicBlocks %}
          {% for questionAnswerBlock in questionAnswerBlocks %}
            {% if questionAnswerBlock.settings.subtopic_id == subtopicBlock.settings.id %}
              {% render 'faq-qna-accordion', question: questionAnswerBlock.settings.question_1, answer: questionAnswerBlock.settings.answer_1, html: questionAnswerBlock.settings.html_1 %}
              {% render 'faq-qna-accordion', question: questionAnswerBlock.settings.question_2, answer: questionAnswerBlock.settings.answer_2, html: questionAnswerBlock.settings.html_2 %}
              {% render 'faq-qna-accordion', question: questionAnswerBlock.settings.question_3, answer: questionAnswerBlock.settings.answer_3, html: questionAnswerBlock.settings.html_3 %}
            {% endif %}
          {% endfor %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<script type="module">
  $('.accordion-wrapper').beefup({
    trigger: ".accordion",
    content: ".accordion__content",
    openSpeed: 100,
    closeSpeed: 100
  });
</script>

{% schema %}
{
  "name": "Question & Answer",
  "class": "faq-qa-section",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "topic_title",
      "label": "Topic title"
    },
    {
      "id": "slug",
      "type": "text",
      "label": "Section slug",
      "info": "Question & Answer section slug should be unique and follow slug format. Slug format example: top-questions"
    }
  ],
  "blocks": [
    {
      "type": "subtopic",
      "name": "Subtopic",
      "settings": [
        {
          "type": "text",
          "id": "id",
          "label": "Subtopic ID"
        }
      ]
    },
    {
      "type": "question_and_answer",
      "name": "Question & Answer",
      "settings": [
        {
          "type": "text",
          "id": "subtopic_id",
          "label": "Child of subtopic ID"
        },
        {
          "type": "text",
          "id": "question_1",
          "label": "Question 1"
        },
        {
          "type": "richtext",
          "id": "answer_1",
          "label": "Answer 1"
        },
        {
          "type": "text",
          "id": "html_1",
          "label": "Custom HTML 1"
        },
        {
          "type": "text",
          "id": "question_2",
          "label": "Question 2"
        },
        {
          "type": "richtext",
          "id": "answer_2",
          "label": "Answer 2"
        },
        {
          "type": "text",
          "id": "html_2",
          "label": "Custom HTML 2"
        },
        {
          "type": "text",
          "id": "question_3",
          "label": "Question 3"
        },
        {
          "type": "richtext",
          "id": "answer_3",
          "label": "Answer 3"
        },
        {
          "type": "text",
          "id": "html_3",
          "label": "Custom HTML 3"
        }
      ]
    }
  ]
}
{% endschema %}